# Multi-Model Development Workflow - モデル切り替え依頼

## 概要

Multi-Model Development Workflowに**モデル切り替え依頼**の仕組みを追加しました。これにより、Auto (Sonnet 3.5)とClaude 4.5 Sonnetの役割分担がより明確になり、ユーザーの判断ポイントが明確化されました。

## 🔄 正常完了時のモデル切り替え依頼

### Auto (Sonnet 3.5)の責務
実装完了後、**必ず**ユーザーに以下を依頼：

```
✅ 実装が完了しました。

次のステップ: 評価・修正のためにClaude 4.5 Sonnetに切り替えてください。

【完了した作業】
- Issue作成・ブランチ作成
- コード実装
- テスト実行（115 passed, 15 skipped）
- コミット・PR作成

【4.5 Sonnetで実行する作業】
- コーディング規約チェック
- 設計パターン検証
- リンターエラー修正
- 必要に応じて追加修正

Cursorでモデルを4.5 Sonnetに切り替えてから、評価・修正を開始してください。
```

## 🔄 ワークフロー内のモデル切り替え依頼

### 実装完了後の流れ
1. **Auto (Sonnet 3.5)**: 実装完了
2. **Auto (Sonnet 3.5)**: ユーザーにモデル切り替えを依頼
3. **ユーザー**: Cursorでモデルを4.5 Sonnetに切り替え
4. **Claude 4.5 Sonnet**: 評価・修正を実行

## 🔄 4.5 Sonnet解決後のハンドオフ

### 評価・修正完了後
- Serenaメモリに評価結果を記録（`refactoring_plan`を更新）
- 修正内容をコミット（修正があった場合）
- ユーザーに「評価・修正完了」を報告
- 次のPhaseの準備またはPRマージの準備

### エスカレーション解決後
- Serenaメモリに解決策を記録（`current_issues`または新規メモリ）
- 明確な次のステップを文書化
- Autoが参照できる形で指示を残す
- ユーザーに「Auto (Sonnet 3.5)に戻してください」を依頼

## 🎯 効果

### 明確化されたポイント
- ✅ **モデル切り替えのタイミング**: 実装完了時
- ✅ **役割分担**: Auto=実装、4.5=評価・修正
- ✅ **ユーザーの判断ポイント**: モデル切り替えのタイミング
- ✅ **ワークフローの自動化**: 明確な手順

### 品質向上
- ✅ **コスト効率**: 実装はSonnet 3.5、評価・レビュー対応はSonnet 4.5で最適化
- ✅ **品質保証**: 複数段階のチェック（評価 → BugBot → レビュー対応）
- ✅ **明確な役割分担**: 各ステップで責任が明確
- ✅ **自動化**: BugBotが自動レビュー、Issueも自動クローズ

## 📝 実装例

### Phase 4-3での適用
- **Auto (Sonnet 3.5)**: global.tsのリファクタリング実装完了
- **Auto (Sonnet 3.5)**: ユーザーにモデル切り替えを依頼
- **ユーザー**: Cursorで4.5 Sonnetに切り替え
- **Claude 4.5 Sonnet**: 評価・修正を実行（軽微な改善を実施）

## 🚀 今後の適用

### すべてのPhaseで適用
- Phase 4-4 (sequence.ts)
- Phase 5以降のリファクタリング
- 新機能開発
- バグ修正

### エスカレーション時も適用
- 問題発生時の4.5 Sonnetへの切り替え依頼
- 解決後のAuto (Sonnet 3.5)への戻し依頼

## 📋 更新されたドキュメント

- `docs/PROJECT_RULES.md`: Multi-Model Development Workflowセクションを更新
- 正常完了時のモデル切り替え依頼を追加
- エスカレーション判断基準を拡張
- 4.5 Sonnet解決後のハンドオフを明確化

## 🎯 成功基準

- ✅ Auto (Sonnet 3.5)が実装完了時に必ずモデル切り替えを依頼
- ✅ ユーザーが適切なタイミングでモデルを切り替え
- ✅ Claude 4.5 Sonnetが評価・修正を実行
- ✅ 役割分担が明確に機能
- ✅ ワークフローが自動化される