# Beat/Meter Specification - 拍子記号の仕様

## 現在の実装（v2.0）
- 構文: `beat(n1 by n2)` - n1=分子、n2=分母
- **分母に制限なし**（任意の正の数値を受け入れる）
- 数学的には正しく計算される

## 将来の方針（Phase 2以降）

### 分母の制約 - 慎重に検討中
**当初の提案**: 1, 2, 4, 8, 16, 32, 64, 128（2のべき乗のみ）

**しかし**:
- **9分音符、10分音符などの非標準的な分母も有用な可能性**
- ポリリズム/ポリテンポの文脈では、`beat(9 by 10)`のような表記が**数学的に意味があり、直感的**かもしれない
- 現在の柔軟な実装により、実験的な使用や新しいリズム表現が可能
- **Phase 2で制約を導入するかは、実際の使用例とフィードバックを基に慎重に判断**

### 小節長の計算
```
4分音符の長さ = 60000 / tempo (ms)
1小節の長さ = (60000 / tempo) × (numerator / denominator × 4) (ms)
```

**例**:
- `tempo(60) beat(4 by 4)` → 1小節 = 4000ms
- `tempo(60) beat(7 by 8)` → 1小節 = 3500ms
- `tempo(60) beat(9 by 10)` → 1小節 = 3600ms（実験的）

### ポリメーター機能
各シーケンスが独立した拍子を持ち、小節線が徐々にずれる：

```js
global.tempo(60)
global.beat(4 by 4)        // 1小節 = 4秒
seq1.beat(5 by 4)          // 1小節 = 5秒
// → 位相がずれてパターンが回り込む
```

### 用語の改善案
- `tempo()` → `bpm()`へのエイリアス追加
- 理由: BPM（Beats Per Minute）はより一般的で理解しやすい
- 実装: 両方サポートし、後方互換性を維持

## Phase 2での検討事項
1. 分母の検証を**警告**として実装（エラーではない）
2. 実験的な拍子のテストケース追加
3. ポリリズム文脈での非標準分母の有用性を評価
4. 実際の使用例に基づいて制約の必要性を判断

## 現時点の方針
- **Phase 1**: 厳密な制約を課さず、柔軟性を優先
- **理由**: ポリメーター機能の動作を優先、実験的な使用を妨げない
- **Phase 2**: 慎重に検討し、必要に応じて警告機能を追加（制約ではなく）

## 詳細ドキュメント
`docs/BEAT_METER_SPECIFICATION.md`を参照
