// Polymeter test - SuperCollider
var global = init GLOBAL
global.tempo(120).beat(4 by 4)
global.audioPath("test-assets/audio")

var kick = init global.seq
kick.audio("kick.wav")
kick.play(1, 0, 1, 0)
kick.length(120)

var snare = init global.seq
snare.beat(5 by 4)
snare.audio("snare.wav")
snare.play(1, 0, 1, 0)
snare.length(200)

var hat = init global.seq
hat.beat(3 by 4)
hat.audio("hihat.wav").chop(2)
hat.play(1, 2, 1, 2)
hat.length(240)

var break = init global.seq
break.beat(4 by 4)
break.audio("BRV_100_Rap_Stabs_Loop_01.wav").chop(4)
break.play(1, 0, , 1, 4, 2, 1, 0, 1, 0, (1, 1, (2, 4, (1, 2, 1))), 1, 0)
break.length(8)

var arp = init global.seq
arp.beat(5 by 4)
arp.audio("arpeggio_c.wav").chop(4)
arp.play(1, (2, (3, 4), (1, 2, (3, 4))), 1, (2, (3, 4), (1, 2, (3, 4))))
arp.length(8)

var chord = init global.seq
chord.beat(4 by 4)
chord.audio("chord_c_major.wav").chop(4)
chord.play(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0)
// chord.length(8)

var voice = init global.seq
voice.beat(2 by 4)
voice.audio("WW_OLYA_150_vocal_chop_topline_Fm.wav").chop(4)
voice.play(1, (3, (4,4,4), (3, 4)), (3, 3, 0))
voice.length(8)

var voice2 = init global.seq
voice2.beat(2 by 4)
voice2.audio("JJP_90SS_136_vocal_harmonies_shogi_C#m.wav").chop(16)
voice2.play(1, 2, 8, (9, 10, (11, 12, 13, (14, 15))), 14, 13)
voice2.length(8)

// Commands for live coding:
global.run()
kick.loop()
snare.loop().gain(r-6%3)
hat.loop().pan(r)
break.loop().gain(r0%3).pan(r)
arp.loop().gain(r0%3).pan(r)
chord.loop().gain(r0%3).pan(r)
voice.loop().gain(r0%3).pan(r)
voice2.loop().gain(r0%3).pan(r)
global.stop()break


kick.stop()
snare.stop().gain(r-6%3)
hat.stop().pan(r)
break.stop().gain(r0%3).pan(r)
arp.stop().gain(r0%3).pan(r)
chord.stop().gain(r0%3).pan(r)
voice.stop().gain(r0%3).pan(r)
voice2.stop().gain(r0%3).pan(r)